(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{26:function(e,t,n){e.exports=n(38)},35:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(14),c=n.n(o),i=n(6),l=n(11),u=n(10),s=n(23),d=localStorage.getItem("webisticsJWT")||"none",m={isLoggedIn:"none"!==d,token:d},p={endpoint:"https://t0c4v0ovd0.execute-api.us-west-1.amazonaws.com/dev"},g=Object(u.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object.assign({},e,{isLoggedIn:!0});case"LOGOUT":return Object.assign({},e,{isLoggedIn:!1});case"SET_TOKEN":return Object.assign({},e,{token:t.payload});default:return e}},feed:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;return t.type,e}}),h=[s.a];n(35);var f=n(9),v=n(24);function E(e){var t=e.children,n=e.isLoggedIn,a=Object(v.a)(e,["children","isLoggedIn"]);return r.a.createElement(f.b,Object.assign({},a,{render:function(e){var a=e.location;return n?t:r.a.createElement(f.a,{to:{pathname:"/login",state:{from:a}}})}}))}var b=n(13);var O=Object(f.g)((function(e){var t=e.history,n=Object(i.c)((function(e){return e.feed.endpoint})),o=Object(i.b)(),c=Object(a.useState)(""),l=Object(b.a)(c,2),u=l[0],s=l[1],d=Object(a.useState)(""),m=Object(b.a)(d,2),p=m[0],g=m[1];return r.a.createElement("form",{className:"loginForm",onSubmit:function(e){e.preventDefault();var a={username:u,password:p};fetch(n+"/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){if(200===e.status)return e.json();throw new Error("Error authenticating user")})).then((function(e){var n;n=e.token,localStorage.setItem("webisticsJWT",n),o(function(e){return{type:"SET_TOKEN",payload:e}}(n)),o({type:"LOGIN",payload:void 0}),t.push("/")})).catch(console.error)}},r.a.createElement("input",{type:"text",id:"username",name:"username",placeholder:"Username",value:u,onChange:function(e){return s(e.target.value)}}),r.a.createElement("input",{type:"password",id:"password",name:"password",placeholder:"Password",value:p,onChange:function(e){return g(e.target.value)}}),r.a.createElement("button",{type:"submit"},"Submit"))}));var j=function(){return r.a.createElement("div",{className:"loginPage"},r.a.createElement(O,null))};var w=function(){var e=Object(i.c)((function(e){return e.feed.endpoint})),t=Object(i.c)((function(e){return e.auth.token})),n=Object(a.useState)([]),o=Object(b.a)(n,2),c=o[0],l=o[1];return Object(a.useEffect)((function(){console.log(e),fetch(e+"/analytics",{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).then((function(e){e.length>0&&l(e)})).catch(console.error)}),[e,t]),r.a.createElement("div",{className:"feed"},c&&c.map((function(e){return r.a.createElement("div",{className:"view",key:e.id},r.a.createElement("p",null,e.ipAddress),r.a.createElement("p",null,e.org),r.a.createElement("p",null,e.city),r.a.createElement("p",null,e.longitude),r.a.createElement("p",null,e.latitude),r.a.createElement("p",null,new Date(e.date).toDateString()))})))};n(37);var y=function(){var e=Object(i.c)((function(e){return e.auth.isLoggedIn}));return r.a.createElement("div",{className:"App"},r.a.createElement(f.d,null,r.a.createElement(E,{exact:!0,path:"/",isLoggedIn:e},r.a.createElement(w,null)),r.a.createElement(f.b,{exact:!0,path:"/login"},r.a.createElement(j,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var I,S=(I={},Object(u.d)(g,I,u.a.apply(void 0,h)));c.a.render(r.a.createElement(i.a,{store:S},r.a.createElement(l.a,null,r.a.createElement(y,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[26,1,2]]]);
//# sourceMappingURL=main.186b20cf.chunk.js.map
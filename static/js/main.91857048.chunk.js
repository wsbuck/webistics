(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{27:function(e,t,n){e.exports=n(39)},36:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(14),o=n.n(c),i=n(6),l=n(12),u=n(11),s=n(23),d=localStorage.getItem("webisticsJWT")||"none",m={isLoggedIn:"none"!==d,token:d},h={endpoint:"https://t0c4v0ovd0.execute-api.us-west-1.amazonaws.com/dev"},g=Object(u.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object.assign({},e,{isLoggedIn:!0});case"LOGOUT":return Object.assign({},e,{isLoggedIn:!1});case"SET_TOKEN":return Object.assign({},e,{token:t.payload});default:return e}},feed:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;return t.type,e}}),p=[s.a];n(36);var f=n(9),v=n(24);function b(e){var t=e.children,n=e.isLoggedIn,a=Object(v.a)(e,["children","isLoggedIn"]);return r.a.createElement(f.b,Object.assign({},a,{render:function(e){var a=e.location;return n?t:r.a.createElement(f.a,{to:{pathname:"/login",state:{from:a}}})}}))}var E=n(10),O=n(26),j=function(){return r.a.createElement("div",{className:"loader-container"},r.a.createElement("div",{className:"loader",style:{width:30,height:30}},r.a.createElement("div",{className:"loader",style:{width:20,height:20}},r.a.createElement("div",{className:"loader",style:{width:10,height:10}}))))};var w=Object(f.g)((function(e){var t=e.history,n=Object(i.c)((function(e){return e.feed.endpoint})),c=Object(i.b)(),o=Object(a.useState)(""),l=Object(E.a)(o,2),u=l[0],s=l[1],d=Object(a.useState)(""),m=Object(E.a)(d,2),h=m[0],g=m[1],p=Object(a.useState)(!1),f=Object(E.a)(p,2),v=f[0],b=f[1],w=Object(a.useState)(!1),y=Object(E.a)(w,2),S=y[0],N=y[1];return r.a.createElement("form",{className:Object(O.a)("loginForm",S&&"error"),onSubmit:function(e){e.preventDefault(),b(!0);var a={username:u,password:h};fetch(n+"/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){if(200===e.status)return e.json();throw new Error("Error authenticating user")})).then((function(e){var t;t=e.token,localStorage.setItem("webisticsJWT",t),c(function(e){return{type:"SET_TOKEN",payload:e}}(t))})).then((function(){b(!1),c({type:"LOGIN",payload:void 0}),t.push("/")})).catch((function(e){b(!1),N(!0),s(""),g(""),console.error(e)}))}},r.a.createElement("input",{type:"text",id:"username",name:"username",placeholder:"Username",value:u,onChange:function(e){return s(e.target.value)}}),r.a.createElement("input",{type:"password",id:"password",name:"password",placeholder:"Password",value:h,onChange:function(e){return g(e.target.value)}}),r.a.createElement("button",{type:"submit"},"Submit"),v&&r.a.createElement(j,null))}));var y=function(){return r.a.createElement("div",{className:"loginPage"},r.a.createElement(w,null))};var S=function(){var e=Object(i.c)((function(e){return e.feed.endpoint})),t=Object(i.c)((function(e){return e.auth.token})),n=Object(a.useState)([]),c=Object(E.a)(n,2),o=c[0],l=c[1],u=Object(a.useState)(!1),s=Object(E.a)(u,2),d=s[0],m=s[1];return Object(a.useEffect)((function(){console.log(e),m(!0),fetch(e+"/analytics",{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).then((function(e){e.length>0&&l(e)})).then((function(){setTimeout((function(){return m(!1)}),2e3)})).catch((function(e){console.error(e),m(!1)}))}),[e,t]),r.a.createElement("div",{className:"feed"},d&&r.a.createElement(j,null),o&&!d&&o.map((function(e){return r.a.createElement("div",{className:"view",key:e.id},r.a.createElement("p",null,e.ipAddress),r.a.createElement("p",null,e.org),r.a.createElement("p",null,e.city),r.a.createElement("p",null,e.longitude),r.a.createElement("p",null,e.latitude),r.a.createElement("p",null,new Date(e.date).toDateString()))})))};n(38);var N=function(){var e=Object(i.c)((function(e){return e.auth.isLoggedIn}));return r.a.createElement("div",{className:"App"},r.a.createElement(f.d,null,r.a.createElement(b,{exact:!0,path:"/",isLoggedIn:e},r.a.createElement(S,null)),r.a.createElement(f.b,{exact:!0,path:"/login"},r.a.createElement(y,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var I,L=(I={},Object(u.d)(g,I,u.a.apply(void 0,p)));o.a.render(r.a.createElement(i.a,{store:L},r.a.createElement(l.a,null,r.a.createElement(N,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[27,1,2]]]);
//# sourceMappingURL=main.91857048.chunk.js.map